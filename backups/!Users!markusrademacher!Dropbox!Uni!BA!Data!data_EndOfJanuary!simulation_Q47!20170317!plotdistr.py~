import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns; sns.set(style="white", color_codes=True)
import os, fnmatch,csv
from matplotlib.backends.backend_pdf import PdfPages


#DataList=[]
'''
for root, dirs, files in os.walk(os.getcwd()):
    for file in files:
        if fnmatch.fnmatch(file,"distribution.dat"): 
            print(os.path.join(root, file))'''

'''with open('distribution.dat', 'rt') as f:
  reader = csv.reader(f, delimiter='\t', skipinitialspace=True)

  lineData = list()

  cols = next(reader)
  print(cols)

  for col in cols:
    # Create a list in lineData for each column of data.
    lineData.append(list())


  for line in reader:
    for i in range(0, len(lineData)):
      # Copy the data from the line into the correct columns.
      lineData[i].append(line[i])

  data = dict()
  data[initialDistr]=lineData[0]
  data[initialDistr_v]=lineData[1]
  data[EndDistr]=lineData[2]
  data[EndDistr_v]=lineData[3]

  for i in range(0, len(cols)):
    # Create each key in the dict with the data in its column.
    data[cols[i]] = lineData[i]

print(np.asarray(data['initialDistr']))'''
ROI=[0.0001,0.0004,0.0007,0.001,0.0013,0.0016,0.0019,0.0022,0.0025,0.0028,0.0031,0.0034,0.0037,0.004,0.0043,0.0046,0.0049,0.0052,0.0055,0.0058,0.0061,0.0064,0.0067,0.007,0.0073,0.0076,0.0079,0.0082,0.0085,0.0088,0.0091,0.0094]
with PdfPages('distributions.pdf') as pdf_pages:
    for i in range(1, 2):
        print(i)
        data = np.loadtxt('distribution_run'+str(i)+'.dat',delimiter='\t')
        #print(data[:,0])
        xint = pd.Series(data[:,0], name="$x$")
        vint = pd.Series(data[:,1], name="$v$")
        xend = pd.Series(data[:,2], name="$x$")
        vend = pd.Series(data[:,3], name="$v$")
        JG1 = sns.jointplot(xint, vint, kind='kde',xlim={-1.5e-9,1.5e-9},ylim={-0.015,0.015}) #,stat_func=None
        #JG1 = sns.jointplot(xint, vint, kind="kde", color="m")
        #JG1.plot_joint(plt.scatter, c="w", s=10, linewidth=0.5, marker="+")
        #JG1.ax_joint.collections[0].set_alpha(0)
        #JG1.set_axis_labels("$X$", "$Y$");
        JG1.ax_joint.text(0,0.025,
                          'Distribution at the beginning of \n %.2fµs cooling cycle' %((1/(ROI[i-1]*np.sqrt(5)*2*np.pi*292532))*10**6),
                          horizontalalignment='center')
        JG1.ax_joint.text(-2.25e-9,0.035,
                          'Simulation Data',
                          horizontalalignment='center',
                          fontsize=20)
        JG1.ax_joint.text(-2.25e-9 ,0.032,
                          'cooling factor = 5.17631, Q=47, ω=2π*292532Hz',
                          horizontalalignment='center')
        JG2 = sns.jointplot(xend, vend, kind='kde',xlim={-0.75e-9,0.75e-9},ylim={-0.002,0.002})
        JG2.ax_joint.text(0,0.0033,
                         'Distribution at the end of \n %.2fµs cooling cycle' %((1/(ROI[i-1]*np.sqrt(5)*2*np.pi*292532))*10**6),
                          horizontalalignment='center')
       
        #subplots migration
        f = plt.figure()

        for J in [JG1, JG2]:
            for A in J.fig.axes:
                f._axstack.add(f._make_key(A), A)
                #print(A)
        #subplots size adjustment
        f.axes[0].set_position([0.10, 0.10, 0.3,  0.3])
        f.axes[1].set_position([0.10, 0.40, 0.3,  0.05])
        f.axes[2].set_position([0.40, 0.10, 0.05, 0.3])
        f.axes[3].set_position([0.55, 0.10, 0.3,  0.3])
        f.axes[4].set_position([0.55, 0.40, 0.3,  0.05])
        f.axes[5].set_position([0.85, 0.10, 0.05, 0.3])
        '''fig = plt.figure()
        ax1 = fig.add_subplot(121)
        sns.jointplot(xint,vint,kind="kde",dropna=True, ax=ax1)
        ax2 = fig.add_subplot(122)
        sns.jointplot(xend,vend,kind="kde",dropna=True, ax=ax2)
'''
        
       
        pdf_pages.savefig()
        plt.close('all')
'''data = np.loadtxt('distribution_run2.dat',delimiter='\t')
#print(data[:,0])
x = pd.Series(data[:,2], name="$x$")
v = pd.Series(data[:,3], name="$v$")

sns.jointplot(x,v,kind="kde")
'''
#tips = sns.load_dataset("tips")
#g = sns.jointplot(x="total_bill", y="tip", data=tips)'''

